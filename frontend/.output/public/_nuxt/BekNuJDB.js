import{Q as ce,J as fe,S as me,k as N,r as u,s as ve,L as ye,o as ne,T as q,e as xe,a7 as Ve,B as s,U as $,Z as O,a8 as ge,a9 as we,z as y,P as j,aa as Y,ab as pe,O as be,ac as Fe,ad as Ce,a3 as ee,C as p,a6 as he,y as B,D,A as ke,K as t,x as Q,a4 as te,a5 as _e}from"./B_9B--Gh.js";import{u as Pe,b as Ie,c as Re,d as Se}from"./-qS-kRan.js";import{V as qe}from"./BYKkqKro.js";import{V as Be}from"./BR29G1Jp.js";import{V as Ne,a as Te}from"./BiPnY-5w.js";import{k as Ae,l as ae,n as le,f as Ue,o as ze,p as De,q as Ee,r as Me,V as He,j as Ge}from"./COzGDrdo.js";import{I as oe,a as Le,d as J,e as $e}from"./C9JAJKl2.js";import"./CypGsUf9.js";const Oe=fe({autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:e=>!isNaN(parseFloat(e))},maxRows:{type:[Number,String],validator:e=>!isNaN(parseFloat(e))},suffix:String,modelModifiers:Object,...De(),...ze()},"VTextarea"),je=ce()({name:"VTextarea",directives:{vIntersect:oe},inheritAttrs:!1,props:Oe(),emits:{"click:control":e=>!0,"mousedown:control":e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(e,R){let{attrs:b,emit:F,slots:d}=R;const i=me(e,"modelValue"),{isFocused:m,focus:x,blur:C}=Ae(e),{onIntersect:c}=Me(e),r=N(()=>typeof e.counterValue=="function"?e.counterValue(i.value):(i.value||"").toString().length),E=N(()=>{if(b.maxlength)return b.maxlength;if(!(!e.counter||typeof e.counter!="number"&&typeof e.counter!="string"))return e.counter}),h=u(),f=u(),T=ve(""),k=u(),M=N(()=>e.persistentPlaceholder||m.value||e.active);function S(){var l;k.value!==document.activeElement&&((l=k.value)==null||l.focus()),m.value||x()}function o(l){S(),F("click:control",l)}function a(l){F("mousedown:control",l)}function n(l){l.stopPropagation(),S(),O(()=>{i.value="",Fe(e["onClick:clear"],l)})}function re(l){var g;const v=l.target;if(i.value=v.value,(g=e.modelModifiers)!=null&&g.trim){const I=[v.selectionStart,v.selectionEnd];O(()=>{v.selectionStart=I[0],v.selectionEnd=I[1]})}}const _=u(),A=u(Number(e.rows)),H=N(()=>["plain","underlined"].includes(e.variant));ye(()=>{e.autoGrow||(A.value=Number(e.rows))});function P(){e.autoGrow&&O(()=>{if(!_.value||!f.value)return;const l=getComputedStyle(_.value),v=getComputedStyle(f.value.$el),g=parseFloat(l.getPropertyValue("--v-field-padding-top"))+parseFloat(l.getPropertyValue("--v-input-padding-top"))+parseFloat(l.getPropertyValue("--v-field-padding-bottom")),I=_.value.scrollHeight,U=parseFloat(l.lineHeight),G=Math.max(parseFloat(e.rows)*U+g,parseFloat(v.getPropertyValue("--v-input-control-height"))),L=parseFloat(e.maxRows)*U+g||1/0,w=we(I??0,G,L);A.value=Math.floor((w-g)/U),T.value=ge(w)})}ne(P),q(i,P),q(()=>e.rows,P),q(()=>e.maxRows,P),q(()=>e.density,P);let V;return q(_,l=>{l?(V=new ResizeObserver(P),V.observe(_.value)):V==null||V.disconnect()}),xe(()=>{V==null||V.disconnect()}),Le(()=>{const l=!!(d.counter||e.counter||e.counterValue),v=!!(l||d.details),[g,I]=Ve(b),{modelValue:U,...G}=ae.filterProps(e),L=le.filterProps(e);return s(ae,$({ref:h,modelValue:i.value,"onUpdate:modelValue":w=>i.value=w,class:["v-textarea v-text-field",{"v-textarea--prefixed":e.prefix,"v-textarea--suffixed":e.suffix,"v-text-field--prefixed":e.prefix,"v-text-field--suffixed":e.suffix,"v-textarea--auto-grow":e.autoGrow,"v-textarea--no-resize":e.noResize||e.autoGrow,"v-input--plain-underlined":H.value},e.class],style:e.style},g,G,{centerAffix:A.value===1&&!H.value,focused:m.value}),{...d,default:w=>{let{id:z,isDisabled:K,isDirty:Z,isReadonly:ie,isValid:se}=w;return s(le,$({ref:f,style:{"--v-textarea-control-height":T.value},onClick:o,onMousedown:a,"onClick:clear":n,"onClick:prependInner":e["onClick:prependInner"],"onClick:appendInner":e["onClick:appendInner"]},L,{id:z.value,active:M.value||Z.value,centerAffix:A.value===1&&!H.value,dirty:Z.value||e.dirty,disabled:K.value,focused:m.value,error:se.value===!1}),{...d,default:ue=>{let{props:{class:W,...X}}=ue;return y(j,null,[e.prefix&&y("span",{class:"v-text-field__prefix"},[e.prefix]),Y(y("textarea",$({ref:k,class:W,value:i.value,onInput:re,autofocus:e.autofocus,readonly:ie.value,disabled:K.value,placeholder:e.placeholder,rows:e.rows,name:e.name,onFocus:S,onBlur:C},X,I),null),[[oe,{handler:c},null,{once:!0}]]),e.autoGrow&&Y(y("textarea",{class:be([W,"v-textarea__sizer"]),id:`${X.id}-sizer`,"onUpdate:modelValue":de=>i.value=de,ref:_,readonly:!0,"aria-hidden":"true"},null),[[pe,i.value]]),e.suffix&&y("span",{class:"v-text-field__suffix"},[e.suffix])])}})},details:v?w=>{var z;return y(j,null,[(z=d.details)==null?void 0:z.call(d,w),l&&y(j,null,[y("span",null,null),s(Ee,{active:e.persistentCounter||m.value,value:r.value,max:E.value,disabled:e.disabled},d.counter)])])}:void 0})}),Ue({},h,f,k)}}),Qe={key:0,class:"mb-4"},Je={key:0,class:"d-flex gap-2"},Ke={key:2,class:"text-center py-4"},ot={__name:"[id]",setup(e){const R=he(),b=Ce(),{foods:F}=Pe(),d=u(null),i=u(!1),m=u(!0),x=u(!1),C=u(!1),c=u(""),r=u({id:null,name:"",description:"",quantity:"",can_eat:!1}),E=[{value:"free",label:"Freely"},{value:"moderate",label:"In moderation"},{value:"rarely",label:"Rarely"},{value:"never",label:"Never"}],h=b.params.id,f=N(()=>b.query.view!==void 0);ne(async()=>{await T()});const T=async()=>{try{m.value=!0,c.value="";const o=await F.getById(h);o.food?r.value={id:o.food.id,name:o.food.name,description:o.food.description,quantity:o.food.quantity||"",can_eat:o.food.can_eat===1||o.food.can_eat===!0}:c.value="Food not found"}catch(o){c.value=`Failed to load food: ${o.message}`,console.error("Error loading food:",o)}finally{m.value=!1}},k=async()=>{var o;if((o=d.value)!=null&&o.validate())try{x.value=!0,c.value="";const a={name:r.value.name,description:r.value.description,quantity:r.value.quantity,can_eat:r.value.can_eat?1:0};await F.update(h,a),R.push("/")}catch(a){c.value=`Failed to update food: ${a.message}`,console.error("Error updating food:",a)}finally{x.value=!1}},M=async()=>{if(confirm("Are you sure you want to delete this food item? This action cannot be undone."))try{C.value=!0,c.value="",await F.delete(h),R.push("/")}catch(o){c.value=`Failed to delete food: ${o.message}`,console.error("Error deleting food:",o)}finally{C.value=!1}},S=()=>{R.back()};return(o,a)=>(B(),ee(qe,null,{default:p(()=>[s(Ie,null,{default:p(()=>[s(Re,{class:"text-h5"},{default:p(()=>[D(ke(t(m)?"Loading...":t(f)?"Food Details":"Edit Food Item"),1)]),_:1}),s(Se,null,{default:p(()=>[t(c)?(B(),Q("div",Qe,[s(Be,{type:"error",text:t(c)},null,8,["text"])])):te("",!0),t(m)?(B(),Q("div",Ke,[s($e,{indeterminate:"",color:"primary"}),a[8]||(a[8]=y("p",{class:"mt-2"},"Loading food details...",-1))])):(B(),ee(Ne,{key:1,ref_key:"form",ref:d,modelValue:t(i),"onUpdate:modelValue":a[4]||(a[4]=n=>_e(i)?i.value=n:null),"lazy-validation":""},{default:p(()=>[s(He,{modelValue:t(r).name,"onUpdate:modelValue":a[0]||(a[0]=n=>t(r).name=n),label:"Food Name",readonly:t(f),rules:[n=>!!n||"Food name is required"],required:""},null,8,["modelValue","readonly","rules"]),s(je,{modelValue:t(r).description,"onUpdate:modelValue":a[1]||(a[1]=n=>t(r).description=n),label:"Description",readonly:t(f),rules:[n=>!!n||"Food description is required"],rows:"3",required:""},null,8,["modelValue","readonly","rules"]),s(Ge,{modelValue:t(r).quantity,"onUpdate:modelValue":a[2]||(a[2]=n=>t(r).quantity=n),items:E,"item-title":"label","item-value":"value",label:"Quantity",readonly:t(f),rules:[n=>!!n||"Please select a quantity"],required:""},null,8,["modelValue","readonly","rules"]),s(Te,{modelValue:t(r).can_eat,"onUpdate:modelValue":a[3]||(a[3]=n=>t(r).can_eat=n),color:"success",inset:"","hide-details":"",class:"mb-4",readonly:t(f),label:t(r).can_eat?"Safe to eat":"Not recommended"},null,8,["modelValue","readonly","label"]),t(f)?te("",!0):(B(),Q("div",Je,[s(J,{onClick:k,color:"primary",loading:t(x),disabled:!t(i)||t(x)},{default:p(()=>a[5]||(a[5]=[D(" Update Food ")])),_:1,__:[5]},8,["loading","disabled"]),s(J,{class:"mx-3",onClick:S,color:"grey",variant:"outlined",disabled:t(x)},{default:p(()=>a[6]||(a[6]=[D(" Cancel ")])),_:1,__:[6]},8,["disabled"]),s(J,{onClick:M,color:"error",variant:"outlined",loading:t(C),disabled:t(x)||t(C)},{default:p(()=>a[7]||(a[7]=[D(" Delete ")])),_:1,__:[7]},8,["loading","disabled"])]))]),_:1},8,["modelValue"]))]),_:1})]),_:1})]),_:1}))}};export{ot as default};
